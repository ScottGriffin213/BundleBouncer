using System.Collections.Generic;
using System.Linq;

namespace BundleBouncer.Data 
{
    public class AvatarShitList {
        // Loaded from UserData/BundleBouncer/Avatars.txt in BundleBouncer.OnApplicationStart()
        public static HashSet<string> UserShitList;

        public static bool IsCrasher(string avID) {
            // No fun allowed.
            avID = avID.ToLowerInvariant();

            if(!avID.StartsWith("avtr_")) {
                // Handles kaj's weird invalid bullshit.
                // Will probably also trap some very old avs but IDGAF.
                // FIXME: Whitelist any needed avIDs.
                return true;
            }
            
            // avIDs of crashers hashed so people can't just pull them from the binary.
            string avhash = Utilities.Hash.SHA256String(avID).ToUpperInvariant();

            // The following is a bunch of generated if-trees created by putting
            // a bunch of avID SHA256s into a trie (https://en.wikipedia.org/wiki/Trie) and optimizing it.
            // Why?  Because I wanted to. Also offers some level of obfuscation.
            // Mostly the cool factor, though.
@@CRASHERS@@

            // Check against user shitlist
            if(UserShitList.Contains(avID))
                return true;

            return false;
        }
    }
}